!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t["@jsmini/util-tools"]={})}(this,function(t){"use strict";function e(t){var e=!1;return function(){return e?void 0:(e=!0,t.apply(this,arguments))}}function o(t,e){void 0===e&&(e=500);var o=null;return function(){var n=this,r=arguments;o&&clearTimeout(o),o=setTimeout(function(){t.apply(n,r)},e)}}function n(t,e){void 0===e&&(e=500);var o,n,r=arguments;return function i(){var s=this,a=Date.now();n||(n=a),o&&clearTimeout(o),a-n>=e?(t.apply(s,r),n=a):o=setTimeout(function(){i.apply(s,r)},50)}}function r(t,e,o){void 0===o&&(o="id");var n=Object.create(null);t.forEach(function(t){n[t[o]]=t});var r=[];return t.forEach(function(t){var o=n[t[e]];if(o){(o.children||(o.children=[])).push(t)}else r.push(t)}),r}function i(t,e,o){void 0===e&&(e="name"),void 0===o&&(o="value");var n=[];for(var r in t){var i=Object.create(null);i[e]=r,i[o]=t[r],n.push(i)}return n}function s(t,e,o){void 0===e&&(e="name"),void 0===o&&(o="value");var n=Object.create(null);return t.forEach(function(t){n[t[e]]=t[o]}),n}var a=function(){return a=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++){e=arguments[o];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},a.apply(this,arguments)},c=function(){function t(t){return void 0===t&&(t=!0),this.isSingleInstance=t,this.store={L:JSON.parse(localStorage.getItem("store")||"{}"),S:JSON.parse(sessionStorage.getItem("store")||"{}")},console.log(this.store),this.singleInstance()}return t.prototype.singleInstance=function(){return window&&this.isSingleInstance?(window.$Storage||(window.$Storage=this),window.$Storage):this},t.prototype.addListenerToState=function(){Object.defineProperty(this.store,"S",{enumerable:!0,configurable:!1,set:function(t){console.log("set",this,t)},get:function(){return this.store}})},t.prototype.checkTimeout=function(){},t.prototype.checkType=function(t){return Object.prototype.toString.call(t).slice(8,-1)},t.prototype.transfromDataToInstance=function(t){return{type:this.checkType(t),data:t}},t.prototype.get=function(t,e){var o=e?this.store.L:this.store.S;return"string"==typeof t?(o[t]||{}).data:t.reduce(function(t,e){var n;return a({},t,(n={},n[e]=(o[e]||{}).data,n))},{})},t.prototype.getAll=function(){return this.get(Object.keys(this.store.L).concat(Object.keys(this.store.S)))},t.prototype.set=function(t,e,o,n){var r=this,i=this.checkType(t),s=n?this.store.L:this.store.S;if("String"===i){var c=this.transfromDataToInstance(e);n&&o&&(c=a({},this.transfromDataToInstance(e),{setTime:Date.now(),delay:o,overTime:Date.now()+1e3*o})),s[t]=c}else Object.keys(t).forEach(function(e){return r.set(e,t[e])});sessionStorage.setItem("store",JSON.stringify(this.store.S)),localStorage.setItem("store",JSON.stringify(this.store.L))},t.prototype.remove=function(t,e){var o=this,n=this.checkType(t),r=e?this.store.L:this.store.S;"String"===n?Reflect.deleteProperty(r,t):t.forEach(function(t){return o.remove(t)})},t.prototype.removeAll=function(){this.store={L:{},S:{}}},t.prototype.destroyed=function(){window.$Storage=null},t}();t.__ArrayToMap=s,t.__Debounce=o,t.__MapToArray=i,t.__Once=e,t.__Throttle=n,t.__ToTree=r,t.Storage=c,Object.defineProperty(t,"__esModule",{value:!0})});
